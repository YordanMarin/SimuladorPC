<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Simulador de Amenazas Digitales</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #0f172a 0, #020617 55%);
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    main {
      width: 100%;
      max-width: 1100px;
      margin: 16px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.3);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    header {
      padding: 16px 20px 10px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.25);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    header h1 {
      margin: 0;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    header h1 span.chip {
      font-size: 0.7rem;
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(248, 250, 252, 0.06);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.7);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    #controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
      align-items: center;
    }

    button {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 0.8rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #020617;
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.6);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease;
    }

    button span.icon {
      font-size: 0.9rem;
    }

    button:hover {
      background: #0b1120;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.6);
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(0) scale(0.98);
      box-shadow: none;
    }

    .badge {
      font-size: 0.72rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: #e5e7eb;
      white-space: nowrap;
    }

    .badge-ok {
      background: rgba(22, 163, 74, 0.12);
      border-color: rgba(34, 197, 94, 0.9);
      color: #bbf7d0;
      animation: parpadeoListo 1s ease-in-out infinite;
    }

    @keyframes parpadeoListo {
      0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.3); }
      50% { box-shadow: 0 0 0 6px rgba(22, 163, 74, 0); }
    }

    #layout {
      display: grid;
      grid-template-columns: minmax(260px, 320px) minmax(0, 1fr);
      flex: 1;
      min-height: 420px;
    }

    #panel-izq {
      border-right: 1px solid rgba(148, 163, 184, 0.2);
      padding: 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.12), transparent 55%);
    }

    #panel-der {
      padding: 14px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    h2 {
      font-size: 0.9rem;
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #94a3b8;
    }

    #estado {
      font-size: 0.8rem;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    #progreso-linea {
      position: relative;
      width: 100%;
      height: 7px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 1);
      overflow: hidden;
      border: 1px solid rgba(51, 65, 85, 0.9);
    }

    #progreso-barra {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(90deg, #22c55e, #22d3ee);
      transition: width 0.2s ease-out;
    }

    #mensaje-principal {
      font-size: 0.78rem;
      color: #9ca3af;
    }

    #estadisticas {
      font-size: 0.78rem;
      color: #cbd5f5;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    #estadisticas span {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.9);
    }

    #lista-escenarios {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 280px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .escenario {
      border-radius: 10px;
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(55, 65, 81, 0.9);
      cursor: pointer;
      font-size: 0.8rem;
      display: flex;
      gap: 8px;
      align-items: flex-start;
      transition: background 0.12s ease, border 0.12s ease, transform 0.08s ease;
    }

    .escenario:hover {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), rgba(15, 23, 42, 0.98));
      border-color: rgba(56, 189, 248, 0.9);
      transform: translateY(-1px);
    }

    .escenario-activo {
      background: radial-gradient(circle at top left, rgba(96, 165, 250, 0.18), rgba(15, 23, 42, 0.98));
      border-color: rgba(96, 165, 250, 0.9);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.9);
    }

    .escenario-resuelto {
      border-color: rgba(34, 197, 94, 0.9);
      background: radial-gradient(circle at top left, rgba(22, 163, 74, 0.18), rgba(15, 23, 42, 0.98));
    }

    .escenario-icono {
      font-size: 1.2rem;
      margin-top: 2px;
    }

    .escenario-textos {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .escenario-titulo {
      font-weight: 600;
      color: #e5e7eb;
    }

    .escenario-tags {
      font-size: 0.7rem;
      color: #9ca3af;
    }

    #tips {
      font-size: 0.75rem;
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px dashed rgba(148, 163, 184, 0.6);
      color: #9ca3af;
      margin-top: 6px;
    }

    #tips span.icon {
      margin-right: 6px;
    }

    /* Panel derecho */

    #detalle-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    #detalle-encabezado {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    #detalle-encabezado small {
      font-size: 0.72rem;
      color: #9ca3af;
    }

    #detalle-escenario {
      border-radius: 14px;
      padding: 10px 12px;
      background: radial-gradient(circle at top right, rgba(59, 130, 246, 0.22), rgba(15, 23, 42, 0.98));
      border: 1px solid rgba(148, 163, 184, 0.7);
      min-height: 170px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 0.82rem;
    }

    #detalle-titulo {
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    #detalle-descripcion {
      color: #e5e7eb;
      line-height: 1.35;
    }

    #detalle-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.72rem;
    }

    .badge-mini {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.7);
    }

    .badge-fake {
      background: rgba(239, 68, 68, 0.18);
      border-color: rgba(248, 113, 113, 0.9);
      color: #fecaca;
    }

    #riesgo-botones {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .btn-riesgo {
      flex: 1;
      min-width: 120px;
      justify-content: center;
      border-radius: 10px;
    }

    .btn-riesgo[data-nivel="bajo"] {
      border-color: rgba(34, 197, 94, 0.8);
    }

    .btn-riesgo[data-nivel="medio"] {
      border-color: rgba(250, 204, 21, 0.9);
    }

    .btn-riesgo[data-nivel="alto"] {
      border-color: rgba(248, 113, 113, 0.9);
    }

    .btn-riesgo-desactivado {
      opacity: 0.6;
      cursor: default;
      pointer-events: none;
    }

    #resultado {
      border-radius: 12px;
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(75, 85, 99, 0.9);
      font-size: 0.78rem;
      min-height: 90px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    #resultado-linea {
      font-weight: 600;
    }

    #resultado-linea.ok {
      color: #bbf7d0;
    }

    #resultado-linea.error {
      color: #fecaca;
    }

    #resultado-explicacion {
      color: #e5e7eb;
    }

    #resultado-proteccion {
      color: #bfdbfe;
    }

    #panel-mensajes {
      margin-top: 2px;
      border-radius: 12px;
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(55, 65, 81, 0.9);
      font-size: 0.76rem;
      max-height: 130px;
      overflow-y: auto;
    }

    #panel-mensajes .mensaje {
      margin-bottom: 4px;
      line-height: 1.35;
    }

    #panel-mensajes .mensaje small {
      color: #6b7280;
      font-size: 0.68rem;
    }

    #panel-mensajes .mensaje-ok {
      color: #bbf7d0;
    }

    #panel-mensajes .mensaje-error {
      color: #fecaca;
    }

    #panel-mensajes .mensaje-info {
      color: #bfdbfe;
    }

    @media (max-width: 820px) {
      #layout {
        grid-template-columns: 1fr;
      }
      #panel-izq {
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.2);
      }
      main {
        margin: 8px;
      }
    }

    @media (max-width: 600px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
      #controls {
        width: 100%;
        justify-content: space-between;
      }
    }
  </style>
</head>
<body>
  <main>
    <header>
      <h1>
        üõ°Ô∏è Simulador de Amenazas Digitales
        <span class="chip">Radar de riesgos</span>
      </h1>
      <div id="controls">
        <span id="estado-pasos" class="badge">
          Casos resueltos: <span id="resueltos-num">0</span>/<span id="total-num">0</span>
        </span>
        <button id="btn-sugerir" type="button">
          <span class="icon">üéØ</span>
          Sugerir siguiente caso
        </button>
        <button id="btn-reiniciar" type="button">
          <span class="icon">üîÑ</span>
          Reiniciar simulaci√≥n
        </button>
      </div>
    </header>

    <section id="layout">
      <!-- Panel izquierdo: lista de escenarios y estado -->
      <aside id="panel-izq">
        <h2>Amenazas y situaciones</h2>
        <div id="estado">
          <span>Haz clic en un caso, lee la situaci√≥n y selecciona el nivel de riesgo.</span>
          <div id="progreso-linea">
            <div id="progreso-barra"></div>
          </div>
          <div id="estadisticas">
            <span id="stat-aciertos">‚úÖ Aciertos: 0</span>
            <span id="stat-errores">‚ö†Ô∏è Intentos fallidos: 0</span>
          </div>
          <span id="mensaje-principal"></span>
        </div>

        <div id="lista-escenarios">
          <!-- Se llena desde JS -->
        </div>

        <div id="tips">
          <span class="icon">üí°</span>
          Recuerda sospechar de:
          <strong>urgencias exageradas, premios m√°gicos, enlaces raros, remitentes desconocidos, errores de ortograf√≠a</strong> y mensajes que piden datos personales o dinero.
        </div>
      </aside>

      <!-- Panel derecho: detalle del escenario, botones de riesgo y explicaci√≥n -->
      <section id="panel-der">
        <div id="detalle-wrapper">
          <div id="detalle-encabezado">
            <h2>Evaluaci√≥n de riesgos y falsificaciones</h2>
            <small>Clasifica la situaci√≥n, descubre el nivel de riesgo y aprende c√≥mo protegerte.</small>
          </div>

          <div id="detalle-escenario">
            <div id="detalle-titulo">
              <span>üëÄ Selecciona un caso en la lista para empezar.</span>
            </div>
            <div id="detalle-descripcion">
              Ver√°s aqu√≠ la descripci√≥n completa del escenario de amenaza digital.
            </div>
            <div id="detalle-badges">
              <!-- Se llenan din√°micamente -->
            </div>

            <div id="riesgo-botones">
              <button class="btn-riesgo btn-riesgo-desactivado" data-nivel="bajo">
                ‚úÖ Bajo riesgo
              </button>
              <button class="btn-riesgo btn-riesgo-desactivado" data-nivel="medio">
                ü§î Sospechoso
              </button>
              <button class="btn-riesgo btn-riesgo-desactivado" data-nivel="alto">
                üö® Alta amenaza / Falsificaci√≥n
              </button>
            </div>
          </div>

          <div id="resultado">
            <div id="resultado-linea">Resultado de la evaluaci√≥n‚Ä¶</div>
            <div id="resultado-explicacion"></div>
            <div id="resultado-proteccion"></div>
          </div>

          <div id="panel-mensajes">
            <!-- Mensajes din√°micos -->
          </div>
        </div>
      </section>
    </section>
  </main>

  <script>
    (function () {
      // -------------------------
      // Datos de los escenarios
      // -------------------------
      const escenarios = [
        {
          id: 1,
          icono: "üìß",
          titulo: "Correo de banco con enlace extra√±o",
          categoria: "Phishing",
          riesgo: "alto",
          falsificacion: true,
          descripcion:
            "Recibes un correo que aparenta ser de tu banco. Dice que tu cuenta ser√° bloqueada hoy si no 'verificas tus datos' en un enlace. El remitente tiene una direcci√≥n rara y el enlace no parece del dominio oficial.",
          explicacion:
            "Este es un ejemplo t√≠pico de phishing. Usan urgencia y miedo para que hagas clic y entregues tus credenciales en una p√°gina falsa.",
          proteccion:
            "No hagas clic en enlaces de correos sospechosos. Entra a la web oficial escribiendo t√∫ mismo la direcci√≥n o usando la app del banco. Verifica el remitente y reporta el correo como phishing.",
          resolucion:
            "Marca el correo como spam/phishing en tu bandeja y elimina el mensaje. Si crees que hiciste clic y diste datos, cambia tus contrase√±as y contacta al banco."
        },
        {
          id: 2,
          icono: "üì∂",
          titulo: "WiFi p√∫blico sin contrase√±a",
          categoria: "Red insegura",
          riesgo: "medio",
          falsificacion: false,
          descripcion:
            "Est√°s en un centro comercial y encuentras una red WiFi abierta llamada 'FREE_WIFI_MALL'. No tiene contrase√±a y muchas personas parecen usarla.",
          explicacion:
            "Las redes WiFi abiertas permiten que otros usuarios (o el due√±o del punto de acceso) puedan espiar el tr√°fico si no est√° cifrado.",
          proteccion:
            "Evita acceder a banca, correo o informaci√≥n sensible en redes abiertas. Si necesitas usarlas, usa una VPN y aseg√∫rate de que las webs tengan HTTPS.",
          resolucion:
            "Usa datos m√≥viles para operaciones sensibles y limita el uso del WiFi p√∫blico a navegaci√≥n general poco cr√≠tica."
        },
        {
          id: 3,
          icono: "üîê",
          titulo: "Contrase√±a reutilizada en muchas cuentas",
          categoria: "Gesti√≥n de contrase√±as",
          riesgo: "alto",
          falsificacion: false,
          descripcion:
            "Una persona usa la misma contrase√±a simple (nombre+123) para su correo, redes sociales y banca en l√≠nea.",
          explicacion:
            "Si una sola web se ve comprometida, esa contrase√±a puede ser probada autom√°ticamente en otros servicios (ataque de relleno de credenciales).",
          proteccion:
            "Usa contrase√±as largas y √∫nicas para cada servicio, preferiblemente gestionadas con un gestor de contrase√±as. Activa tambi√©n la verificaci√≥n en dos pasos.",
          resolucion:
            "Cambia las contrase√±as por otras m√°s fuertes y √∫nicas. Activa 2FA donde sea posible."
        },
        {
          id: 4,
          icono: "üì∞",
          titulo: "Noticia viral sin fuente confiable",
          categoria: "Noticia falsa",
          riesgo: "alto",
          falsificacion: true,
          descripcion:
            "Te llega por chat una imagen con texto que dice que ma√±ana se cerrar√°n todos los bancos y que retires tu dinero ya. No hay enlace a un medio oficial y el mensaje est√° lleno de may√∫sculas y emojis alarmantes.",
          explicacion:
            "Es muy probable que sea desinformaci√≥n o noticia falsa dise√±ada para causar p√°nico.",
          proteccion:
            "Antes de compartir, verifica la informaci√≥n en medios oficiales, p√°ginas de instituciones o verificadores de noticias. Desconf√≠a de mensajes alarmistas sin fuentes.",
          resolucion:
            "No compartas la noticia. Busca informaci√≥n en sitios oficiales y, si confirmas que es falsa, avisa a quien te la envi√≥."
        },
        {
          id: 5,
          icono: "üé•",
          titulo: "Video 'deepfake' de una figura p√∫blica",
          categoria: "Deepfake / suplantaci√≥n",
          riesgo: "alto",
          falsificacion: true,
          descripcion:
            "Ves un video en redes donde una figura p√∫blica parece decir algo muy pol√©mico. El movimiento de la boca se ve ligeramente desfasado y la publicaci√≥n viene de una cuenta poco conocida.",
          explicacion:
            "Los deepfakes permiten manipular audio y video para hacer creer que alguien dijo o hizo algo que nunca ocurri√≥.",
          proteccion:
            "Busca la noticia en medios confiables. Revisa si la persona o instituciones oficiales han publicado aclaraciones. Observa detalles visuales raros en el video.",
          resolucion:
            "No difundas el video hasta verificarlo. Reporta el contenido si confirmas que es falso o malicioso."
        },
        {
          id: 6,
          icono: "üì±",
          titulo: "Aplicaci√≥n que pide demasiados permisos",
          categoria: "Apps m√≥viles",
          riesgo: "medio",
          falsificacion: false,
          descripcion:
            "Instalas una app de linterna que pide permisos para acceder a tus contactos, c√°mara, micr√≥fono y ubicaci√≥n en todo momento.",
          explicacion:
            "Pedir permisos innecesarios puede indicar que la app quiere recopilar m√°s datos de los que necesita.",
          proteccion:
            "Descarga solo apps de desarrolladores confiables, revisa rese√±as, limita los permisos y desinstala apps que no uses o que pidan acceso excesivo.",
          resolucion:
            "Revisa y ajusta los permisos de la app o desinst√°lala si no es necesaria."
        },
        {
          id: 7,
          icono: "üíæ",
          titulo: "USB desconocido encontrado en el suelo",
          categoria: "Malware / Ingenier√≠a social",
          riesgo: "alto",
          falsificacion: false,
          descripcion:
            "Encuentras una memoria USB en el estacionamiento de tu centro de estudios. Piensas conectarla para ver de qui√©n es.",
          explicacion:
            "Los USB pueden estar preparados con malware que se ejecuta autom√°ticamente al conectarse a una computadora vulnerable.",
          proteccion:
            "No conectes dispositivos desconocidos a tu equipo. Entr√©galo al √°rea de seguridad o inform√°tica para que lo gestionen de forma segura.",
          resolucion:
            "Evita usar el USB en tu propio dispositivo. Si ya lo conectaste, analiza el equipo con antivirus y consulta al √°rea t√©cnica."
        },
        {
          id: 8,
          icono: "üõí",
          titulo: "Tienda online con descuentos irreales",
          categoria: "Fraude / tienda falsa",
          riesgo: "alto",
          falsificacion: true,
          descripcion:
            "Encuentras una tienda online en redes sociales que vende dispositivos muy caros a precios rid√≠culamente bajos. Solo acepta pago por transferencia directa y no tiene datos de contacto claros.",
          explicacion:
            "Se trata de un patr√≥n t√≠pico de tiendas falsas que cobran y nunca env√≠an el producto.",
          proteccion:
            "Compara opiniones en otras fuentes, revisa si la web aparece en listas de fraude, verifica datos de contacto reales y desconf√≠a de ofertas demasiado buenas.",
          resolucion:
            "No realices pagos. Si alguien cercano ya pag√≥, recomienda contactar al banco para intentar detener la operaci√≥n o denunciar."
        },
        {
          id: 9,
          icono: "üë§",
          titulo: "Solicitud de amistad de perfil casi vac√≠o",
          categoria: "Redes sociales",
          riesgo: "medio",
          falsificacion: posible = true,
          falsificacion: true,
          descripcion:
            "En una red social te llega una solicitud de amistad de un perfil sin foto real, con muy pocas publicaciones y casi sin amigos en com√∫n.",
          explicacion:
            "Puede ser una cuenta falsa usada para obtener tu informaci√≥n, enviar spam o intentar estafas.",
          proteccion:
            "No aceptes solicitudes de personas que no conoces. Revisa si tienen actividad real y amigos en com√∫n, o ignora/bloquea la solicitud.",
          resolucion:
            "No compartas datos personales con cuentas dudosas. Revisa tu configuraci√≥n de privacidad para limitar qui√©n ve tu informaci√≥n."
        },
        {
          id: 10,
          icono: "‚úÖ",
          titulo: "Actualizaci√≥n desde la web oficial",
          categoria: "Buena pr√°ctica",
          riesgo: "bajo",
          falsificacion: false,
          descripcion:
            "Recibes una notificaci√≥n en el navegador indicando que hay una nueva versi√≥n. Te lleva a la p√°gina oficial del desarrollador, con certificado HTTPS v√°lido.",
          explicacion:
            "Actualizar software desde la fuente oficial es una buena pr√°ctica de seguridad.",
          proteccion:
            "Mant√©n tus aplicaciones y sistema operativo actualizados desde canales oficiales, evitando enlaces de terceros sospechosos.",
          resolucion:
            "Revisa que la URL sea realmente la oficial y realiza la actualizaci√≥n normalmente."
        }
      ];

      // -------------------------
      // Referencias a elementos
      // -------------------------
      const listaEscenarios = document.getElementById("lista-escenarios");
      const mensajePrincipal = document.getElementById("mensaje-principal");
      const progresoBarra = document.getElementById("progreso-barra");
      const statAciertos = document.getElementById("stat-aciertos");
      const statErrores = document.getElementById("stat-errores");
      const resueltosNum = document.getElementById("resueltos-num");
      const totalNum = document.getElementById("total-num");
      const estadoPasos = document.getElementById("estado-pasos");

      const detalleTitulo = document.getElementById("detalle-titulo");
      const detalleDescripcion = document.getElementById("detalle-descripcion");
      const detalleBadges = document.getElementById("detalle-badges");
      const botonesRiesgo = Array.from(document.querySelectorAll(".btn-riesgo"));

      const resultadoLinea = document.getElementById("resultado-linea");
      const resultadoExplicacion = document.getElementById("resultado-explicacion");
      const resultadoProteccion = document.getElementById("resultado-proteccion");

      const panelMensajes = document.getElementById("panel-mensajes");

      const btnReiniciar = document.getElementById("btn-reiniciar");
      const btnSugerir = document.getElementById("btn-sugerir");

      // -------------------------
      // Estado de la simulaci√≥n
      // -------------------------
      const estado = {
        seleccionadoId: null,
        resueltos: new Set(),
        aciertos: 0,
        errores: 0
      };

      totalNum.textContent = escenarios.length.toString();

      const mensajesInicio = [
        "Selecciona un caso de la lista y analiza qu√© tan peligroso es.",
        "Piensa siempre: ¬øQui√©n me env√≠a esto? ¬øQu√© quiere que haga?",
        "Reconocer el riesgo es el primer paso de la protecci√≥n digital."
      ];

      const mensajesCorrecto = [
        "Muy bien, tu radar digital est√° afinado üß≠.",
        "Buen an√°lisis, has detectado correctamente el riesgo.",
        "Excelente, as√≠ se detectan amenazas digitales.",
        "¬°Eso es! Una mente cr√≠tica es tu mejor antivirus üß†."
      ];

      const mensajesError = [
        "Casi‚Ä¶ vuelve a leer las pistas del escenario.",
        "Piensa: ¬øqu√© podr√≠a salir mal si conf√≠o en esto?",
        "Analiza el remitente, la urgencia y lo que te piden.",
        "Revisa si hay se√±ales de falsificaci√≥n o exceso de confianza."
      ];

      const mensajesFinal = [
        "Has revisado todos los casos. ¬°Tu nivel de conciencia digital subi√≥ de nivel! üèÜ",
        "Simulaci√≥n completada. Sigues construyendo un buen escudo digital üí™.",
        "Muy bien, has practicado detecci√≥n de riesgos y falsificaciones ‚≠ê."
      ];

      function elegirMensaje(lista) {
        return lista[Math.floor(Math.random() * lista.length)];
      }

      function agregarMensajeLog(texto, tipo = "info") {
        const div = document.createElement("div");
        div.classList.add("mensaje");
        if (tipo === "ok") div.classList.add("mensaje-ok");
        if (tipo === "error") div.classList.add("mensaje-error");
        if (tipo === "info") div.classList.add("mensaje-info");

        const iconos = {
          info: "üí¨",
          ok: "‚úÖ",
          error: "‚ö†Ô∏è"
        };

        const icono = iconos[tipo] || "üí¨";
        const ahora = new Date();
        const hora = ahora.toLocaleTimeString("es-PE", {
          hour: "2-digit",
          minute: "2-digit"
        });

        div.innerHTML = `<strong>${icono}</strong> ${texto} <small>(${hora})</small>`;
        panelMensajes.prepend(div);
      }

      // -------------------------
      // Render de la lista
      // -------------------------
      function renderListaEscenarios() {
        listaEscenarios.innerHTML = "";

        escenarios.forEach(esc => {
          const item = document.createElement("div");
          item.className = "escenario";
          if (estado.resueltos.has(esc.id)) {
            item.classList.add("escenario-resuelto");
          }
          item.dataset.id = esc.id.toString();

          const icono = document.createElement("div");
          icono.className = "escenario-icono";
          icono.textContent = esc.icono;

          const textos = document.createElement("div");
          textos.className = "escenario-textos";

          const titulo = document.createElement("div");
          titulo.className = "escenario-titulo";
          titulo.textContent = esc.titulo;

          const tags = document.createElement("div");
          tags.className = "escenario-tags";
          const etiquetaFake = esc.falsificacion ? "Posible falsificaci√≥n" : "Riesgo digital";
          tags.textContent = `${esc.categoria} ¬∑ ${etiquetaFake}`;

          textos.appendChild(titulo);
          textos.appendChild(tags);

          item.appendChild(icono);
          item.appendChild(textos);

          item.addEventListener("click", () => {
            seleccionarEscenario(esc.id);
          });

          listaEscenarios.appendChild(item);
        });
      }

      function marcarEscenarioActivo(id) {
        const items = Array.from(document.querySelectorAll(".escenario"));
        items.forEach(el => {
          el.classList.remove("escenario-activo");
          const escId = parseInt(el.dataset.id, 10);
          if (escId === id) {
            el.classList.add("escenario-activo");
          }
        });
      }

      // -------------------------
      // Mostrar detalle de escenario
      // -------------------------
      function seleccionarEscenario(id) {
        estado.seleccionadoId = id;
        const esc = escenarios.find(e => e.id === id);
        if (!esc) return;

        marcarEscenarioActivo(id);

        detalleTitulo.innerHTML = `${esc.icono} <span>${esc.titulo}</span>`;
        detalleDescripcion.textContent = esc.descripcion;

        detalleBadges.innerHTML = "";
        const badgeCat = document.createElement("span");
        badgeCat.className = "badge-mini";
        badgeCat.textContent = `Categor√≠a: ${esc.categoria}`;

        const badgeNivel = document.createElement("span");
        badgeNivel.className = "badge-mini";
        const textoNivel =
          esc.riesgo === "bajo"
            ? "Riesgo esperado: Bajo"
            : esc.riesgo === "medio"
            ? "Riesgo esperado: Medio"
            : "Riesgo esperado: Alto";
        badgeNivel.textContent = textoNivel;

        detalleBadges.appendChild(badgeCat);
        detalleBadges.appendChild(badgeNivel);

        if (esc.falsificacion) {
          const badgeFake = document.createElement("span");
          badgeFake.className = "badge-mini badge-fake";
          badgeFake.textContent = "Incluye posible falsificaci√≥n / enga√±o";
          detalleBadges.appendChild(badgeFake);
        }

        // Activar botones de riesgo
        botonesRiesgo.forEach(btn => {
          btn.classList.remove("btn-riesgo-desactivado");
        });

        resultadoLinea.textContent = "Elige un nivel de riesgo para este caso‚Ä¶";
        resultadoLinea.classList.remove("ok", "error");
        resultadoExplicacion.textContent = "";
        resultadoProteccion.textContent = "";

        agregarMensajeLog(
          `Analizando caso: "${esc.titulo}". Clasifica su nivel de riesgo.`,
          "info"
        );
      }

      // -------------------------
      // Evaluar respuesta
      // -------------------------
      function evaluarRiesgo(nivelElegido) {
        if (estado.seleccionadoId === null) {
          agregarMensajeLog("Primero selecciona un caso de la lista.", "error");
          return;
        }

        const esc = escenarios.find(e => e.id === estado.seleccionadoId);
        if (!esc) return;

        const acierto = esc.riesgo === nivelElegido;

        if (acierto) {
          estado.aciertos++;
          estado.resueltos.add(esc.id);
          resultadoLinea.textContent = elegirMensaje(mensajesCorrecto);
          resultadoLinea.classList.remove("error");
          resultadoLinea.classList.add("ok");

          resultadoExplicacion.textContent = esc.explicacion;
          resultadoProteccion.textContent =
            "C√≥mo protegerte / resolver el problema: " + esc.proteccion + " " + esc.resolucion;

          agregarMensajeLog(`Has clasificado correctamente el caso: "${esc.titulo}".`, "ok");
        } else {
          estado.errores++;
          resultadoLinea.textContent = elegirMensaje(mensajesError);
          resultadoLinea.classList.remove("ok");
          resultadoLinea.classList.add("error");

          resultadoExplicacion.textContent =
            "Pista: vuelve a leer la situaci√≥n y preg√∫ntate qu√© podr√≠a salir mal.";
          resultadoProteccion.textContent =
            "Recuerda revisar el remitente, la urgencia, los datos que te piden y si la fuente es confiable.";

          agregarMensajeLog(
            `La clasificaci√≥n para "${esc.titulo}" no es la m√°s adecuada. Intenta de nuevo.`,
            "error"
          );
        }

        actualizarEstadoGlobal();
        renderListaEscenarios();

        if (estado.resueltos.size === escenarios.length) {
          mensajePrincipal.textContent = elegirMensaje(mensajesFinal);
          estadoPasos.classList.add("badge-ok");
        }
      }

      // -------------------------
      // Actualizar estado global
      // -------------------------
      function actualizarEstadoGlobal() {
        resueltosNum.textContent = estado.resueltos.size.toString();
        statAciertos.textContent = `‚úÖ Aciertos: ${estado.aciertos}`;
        statErrores.textContent = `‚ö†Ô∏è Intentos fallidos: ${estado.errores}`;

        const porcentaje = (estado.resueltos.size / escenarios.length) * 100;
        progresoBarra.style.width = porcentaje + "%";

        if (estado.resueltos.size === 0) {
          mensajePrincipal.textContent = elegirMensaje(mensajesInicio);
          estadoPasos.classList.remove("badge-ok");
        } else if (estado.resueltos.size < escenarios.length) {
          mensajePrincipal.textContent =
            "Sigue analizando casos para mejorar tu evaluaci√≥n de riesgos digitales.";
        }
      }

      // -------------------------
      // Reiniciar simulaci√≥n
      // -------------------------
      function reiniciarSimulacion() {
        estado.seleccionadoId = null;
        estado.resueltos = new Set();
        estado.aciertos = 0;
        estado.errores = 0;

        progresoBarra.style.width = "0%";
        resueltosNum.textContent = "0";
        statAciertos.textContent = "‚úÖ Aciertos: 0";
        statErrores.textContent = "‚ö†Ô∏è Intentos fallidos: 0";
        mensajePrincipal.textContent = elegirMensaje(mensajesInicio);
        estadoPasos.classList.remove("badge-ok");

        detalleTitulo.innerHTML = '<span>üëÄ Selecciona un caso en la lista para empezar.</span>';
        detalleDescripcion.textContent =
          "Ver√°s aqu√≠ la descripci√≥n completa del escenario de amenaza digital.";
        detalleBadges.innerHTML = "";
        botonesRiesgo.forEach(btn => btn.classList.add("btn-riesgo-desactivado"));
        resultadoLinea.textContent = "Resultado de la evaluaci√≥n‚Ä¶";
        resultadoLinea.classList.remove("ok", "error");
        resultadoExplicacion.textContent = "";
        resultadoProteccion.textContent = "";

        panelMensajes.innerHTML = "";
        agregarMensajeLog("Simulaci√≥n reiniciada. Vuelve a practicar con los casos de amenazas.", "info");

        renderListaEscenarios();
      }

      // -------------------------
      // Sugerir siguiente caso
      // -------------------------
      function sugerirSiguienteCaso() {
        const pendientes = escenarios.filter(e => !estado.resueltos.has(e.id));
        if (pendientes.length === 0) {
          agregarMensajeLog(
            "Ya has trabajado con todos los casos. Reinicia la simulaci√≥n para practicar otra vez.",
            "info"
          );
          return;
        }

        // Peque√±a l√≥gica: priorizar los de riesgo alto y falsificaci√≥n
        const prioritarios = pendientes.filter(e => e.riesgo === "alto" || e.falsificacion);
        const listaBase = prioritarios.length > 0 ? prioritarios : pendientes;
        const elegido = listaBase[Math.floor(Math.random() * listaBase.length)];

        seleccionarEscenario(elegido.id);
        agregarMensajeLog(
          `Sugerencia: revisa el caso "${elegido.titulo}" y clasifica su nivel de riesgo.`,
          "info"
        );
      }

      // -------------------------
      // Listeners de botones
      // -------------------------
      botonesRiesgo.forEach(btn => {
        btn.addEventListener("click", () => {
          if (btn.classList.contains("btn-riesgo-desactivado")) return;
          const nivel = btn.dataset.nivel;
          evaluarRiesgo(nivel);
        });
      });

      btnReiniciar.addEventListener("click", reiniciarSimulacion);
      btnSugerir.addEventListener("click", sugerirSiguienteCaso);

      // -------------------------
      // Inicializaci√≥n
      // -------------------------
      renderListaEscenarios();
      actualizarEstadoGlobal();
      agregarMensajeLog(
        "Bienvenido al simulador de amenazas digitales. Empieza seleccionando un caso de la lista.",
        "info"
      );
    })();
  </script>
</body>
</html>
